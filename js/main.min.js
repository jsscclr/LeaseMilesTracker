function hideAddressBar(){window.scrollTo(0,1)}function w(e){document.write(e)}function getParameterByName(e){var t=RegExp("[?&]"+e+"=([^&]*)").exec(window.location.search);return t&&decodeURIComponent(t[1].replace(/\+/g," "))}function g(e){var t=window.location.search.replace(/t=./,"");t+="&t="+e,document.location=t}function estimateMiles(e,t){var n=e/12*t;return{perLease:n,perYear:t,perMonth:t/12,perWeek:t/52,perDay:t/365}}function estimateMilesOn(e,t,n){var r=moment(t.leaseStart),i=n||estimateMiles(LeaseInfo.leaseLength,LeaseInfo.milesPerYear),s=e.diff(r,"days"),o=i.perDay*s;return o}function buildForRange(e){var t=e.unit+"s",n=moment(e.aroundDate).startOf("day"),r=n.clone().subtract(t,UNITS_AROUND),i=moment(e.leaseInfo.leaseStart);r.diff(i,t)<0&&(r=i);var s=e.dayStrategy||function(e,n){return e.clone().add(t,n)},o=[],u=estimateMiles(e.leaseInfo.leaseLength,e.leaseInfo.milesPerYear);for(var a=0;a<2*UNITS_AROUND+1;a++){var f={day:s(r,a)},l=n.diff(f.day,t);f.type=l==0?"current info":l>0?"past":"future";var c=estimateMilesOn(f.day,e.leaseInfo,u);f.estimate=c,o.push(f)}return o}function ranger(e){return{d:getDayRange,w:getWeeklyRange,m:getMonthEndRange}[e]}function nmap(e){return{d:"Daily",w:"Weekly",m:"Monthly"}[e]}function getDayRange(e,t){return buildForRange({unit:"day",aroundDate:e,leaseInfo:t})}function getWeeklyRange(e,t){return buildForRange({unit:"week",aroundDate:e,leaseInfo:t,dayStrategy:function(e,t){var n=e.clone().add("weeks",t),r=n.toDate().getDay();return n.add("days",6-r),console.log("for %s + %d end is %s (wd=%d)",e.toString(),t,n.toString(),r),n}})}function getMonthRange(e,t){return buildForRange({unit:"month",aroundDate:e,leaseInfo:t})}function getMonthEndRange(e,t){return buildForRange({unit:"month",aroundDate:e,leaseInfo:t,dayStrategy:function(e,t){return e.clone().add("months",t).endOf("month")}})}function writeLeaseTable(){var e=document,t=e.querySelector("#miles tbody"),n=function(t){return e.createElement(t)},r=function(t,r){var i=n(t),s=e.createTextNode(r);return i.appendChild(s),i};targetDate=getParameterByName("@");var i=function(){today=targetDate?moment(targetDate).startOf("day"):moment().startOf("day"),console.log("painting for ",today),rangeF=ranger(MODE),miles=rangeF(today,LeaseInfo);while(t.firstChild)t.removeChild(t.firstChild);miles.forEach(function(i){var s=n("tr"),o=n("td"),u=e.createAttribute("class");u.value=i.type,s.setAttributeNode(u),txt=e.createTextNode(),s.appendChild(r("td",i.day.toDate().toDateString())),s.appendChild(r("td",Math.floor(i.estimate)+" miles")),t.appendChild(s)})};return i}var UNITS_AROUND=2,LeaseInfo={leaseStart:moment("2012-09-08"),leaseLength:36,milesPerYear:12e3,milesPerYearShort:"12k"},TODAY;(function(e,t,n,r){var i=getParameterByName(t);i&&(e.leaseStart=moment(i));var s=getParameterByName(n);s&&(e.leaseLength=parseInt(s,10));var o=parseInt(getParameterByName(r));o&&(o<1e3?(e.milesPerYear=o*1e3,e.milesPerYearShort=o+"k"):(e.milesPerYear=o,e.milesPerYearShort=o%1e3+"k"))})(LeaseInfo,"s","l","m")